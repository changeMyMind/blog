#### mq概述

##### 1.什么是mq

> 简单一句话了 message queue 消息队列

##### 2.为什么要使用mq

- 异步处理：相对于串行、并行方式，提高了系统吞吐量(因为异步做处理后不需要处理放回结果 有些异步是需要处理返回结果的)
- 应用解耦：系统间的相互通信，不需要关心其他系统的处理逻辑
- 流量削锋：可以通过消息队列长度控制请求量；可以缓解短时间内的高并发请求
- 日志处理：解决大日志传输
- 消息通讯：消息队列一般都内置了高效的通讯机制(`tmd我咋知道是啥通讯机制，为什么效率高哦`)，可以使用在纯的消息通讯上，比如实现点对点的消息队列，或者聊天室等(`一脸懵逼`)

#####3.mq有哪些问题呢

一般有两种问题：

- 消息的顺序问题：指的是 消息的消费 按照消息的发送顺序来消费
  - 解决方案：需要保证顺序的消息发送到同一台机子上(保证生产者和消费者是一对一的关系)
  - 缺陷：多台变一台，吞吐量下降了 甚至会导致阻塞现象 生产环境中其实消息的有序性不怎么关注，这种可以不依赖消息系统本身，依赖处理逻辑也ok
- 消息的重复发送：造成这个问题的原因是 网络不可达
  - 消费端处理消息的业务逻辑保持幂等性。只要保持幂等性，不管来多少条重复消息，最后处理的结果都一样。保证每条消息都有唯一编号且保证消息处理成功与去重表的日志同时出现。利用一张日志表来记录已经处理成功的消息的 ID，如果新到的消息 ID 已经在日志表中，那么就不再处理这条消息。

